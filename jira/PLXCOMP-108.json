{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"65466","self":"http://jira.codehaus.org/rest/api/latest/issue/65466","key":"PLXCOMP-108","fields":{"progress":{"progress":0,"total":0},"summary":"archivers do not detect duplicated files in the archive","timetracking":{},"issuetype":{"self":"http://jira.codehaus.org/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"http://jira.codehaus.org/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"customfield_10110":null,"votes":{"self":"http://jira.codehaus.org/rest/api/2/issue/PLXCOMP-108/votes","votes":9,"hasVoted":false},"resolution":{"self":"http://jira.codehaus.org/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"fixVersions":[],"resolutiondate":"2008-09-18T17:18:28.689-0500","customfield_10210":"2.0","timespent":null,"reporter":{"self":"http://jira.codehaus.org/rest/api/2/user?username=jdcasey","name":"jdcasey","emailAddress":"jdcasey@commonjava.org","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"John Casey","active":true},"aggregatetimeoriginalestimate":null,"customfield_10161":["esengstrom(esengstrom)","jdcasey(jdcasey)"],"customfield_10160":null,"updated":"2008-09-18T17:47:06.102-0500","created":"2008-04-01T16:31:38.476-0500","description":"This allows the same file to be added from two different calls, and the same exact path will be added twice to a single archive, prompting for overwrite when the archive is extracted.","priority":{"self":"http://jira.codehaus.org/rest/api/2/priority/3","iconUrl":"http://jira.codehaus.org/images/icons/priorities/major.png","name":"Major","id":"3"},"duedate":null,"issuelinks":[{"id":"19097","self":"http://jira.codehaus.org/rest/api/2/issueLink/19097","type":{"id":"10001","name":"dependent","inward":"is depended upon by","outward":"depends upon","self":"http://jira.codehaus.org/rest/api/2/issueLinkType/10001"},"inwardIssue":{"id":"63566","key":"MASSEMBLY-285","self":"http://jira.codehaus.org/rest/api/2/issue/63566","fields":{"summary":"regression: duplicate files added to the assembly","status":{"self":"http://jira.codehaus.org/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"http://jira.codehaus.org/images/icons/statuses/closed.png","name":"Closed","id":"6"},"priority":{"self":"http://jira.codehaus.org/rest/api/2/priority/1","iconUrl":"http://jira.codehaus.org/images/icons/priorities/blocker.png","name":"Blocker","id":"1"},"issuetype":{"self":"http://jira.codehaus.org/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"http://jira.codehaus.org/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}}],"customfield_10163":"199497600","watches":{"self":"http://jira.codehaus.org/rest/api/2/issue/PLXCOMP-108/watchers","watchCount":9,"isWatching":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"subtasks":[],"status":{"self":"http://jira.codehaus.org/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"http://jira.codehaus.org/images/icons/statuses/closed.png","name":"Closed","id":"6"},"customfield_10090":null,"labels":[],"workratio":-1,"assignee":{"self":"http://jira.codehaus.org/rest/api/2/user?username=jdcasey","name":"jdcasey","emailAddress":"jdcasey@commonjava.org","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"John Casey","active":true},"attachment":[{"self":"http://jira.codehaus.org/rest/api/2/attachment/36891","id":"36891","filename":"AbstractArchiver.patch","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=esengstrom","name":"esengstrom","emailAddress":"esengstrom@gmail.com","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Erik Engstrom","active":true},"created":"2008-09-05T15:02:05.173-0500","size":8732,"mimeType":"text/x-diff","content":"http://jira.codehaus.org/secure/attachment/36891/AbstractArchiver.patch"},{"self":"http://jira.codehaus.org/rest/api/2/attachment/36890","id":"36890","filename":"DuplicateFilesTest.java","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=esengstrom","name":"esengstrom","emailAddress":"esengstrom@gmail.com","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Erik Engstrom","active":true},"created":"2008-09-05T14:54:43.150-0500","size":3893,"mimeType":"text/x-java","content":"http://jira.codehaus.org/secure/attachment/36890/DuplicateFilesTest.java"}],"customfield_10221":null,"customfield_10220":null,"customfield_10200":null,"aggregatetimeestimate":null,"customfield_10190":null,"project":{"self":"http://jira.codehaus.org/rest/api/2/project/11440","id":"11440","key":"PLXCOMP","name":"Plexus Components","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/projectavatar?size=xsmall&pid=11440&avatarId=10011","24x24":"http://jira.codehaus.org/secure/projectavatar?size=small&pid=11440&avatarId=10011","32x32":"http://jira.codehaus.org/secure/projectavatar?size=medium&pid=11440&avatarId=10011","48x48":"http://jira.codehaus.org/secure/projectavatar?pid=11440&avatarId=10011"},"projectCategory":{"self":"http://jira.codehaus.org/rest/api/2/projectCategory/10003","id":"10003","description":"various containers","name":"containers"}},"versions":[],"customfield_10170":null,"environment":null,"timeestimate":null,"customfield_10130":null,"aggregateprogress":{"progress":0,"total":0},"lastViewed":null,"components":[{"self":"http://jira.codehaus.org/rest/api/2/component/12540","id":"12540","name":"plexus-archiver"}],"comment":{"startAt":0,"maxResults":5,"total":5,"comments":[{"self":"http://jira.codehaus.org/rest/api/2/issue/65466/comment/147163","id":"147163","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=esengstrom","name":"esengstrom","emailAddress":"esengstrom@gmail.com","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Erik Engstrom","active":true},"body":"Here is a unit test that exposes the problem.","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=esengstrom","name":"esengstrom","emailAddress":"esengstrom@gmail.com","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Erik Engstrom","active":true},"created":"2008-09-05T14:54:43.162-0500","updated":"2008-09-05T14:54:43.162-0500"},{"self":"http://jira.codehaus.org/rest/api/2/issue/65466/comment/147165","id":"147165","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=esengstrom","name":"esengstrom","emailAddress":"esengstrom@gmail.com","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Erik Engstrom","active":true},"body":"The unit test depends on src/test/resources/group-writable/foo.txt and src/test/resources/world-writable/foo.txt to have different content in the first line.","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=esengstrom","name":"esengstrom","emailAddress":"esengstrom@gmail.com","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Erik Engstrom","active":true},"created":"2008-09-05T14:59:36.327-0500","updated":"2008-09-05T14:59:36.327-0500"},{"self":"http://jira.codehaus.org/rest/api/2/issue/65466/comment/147166","id":"147166","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=esengstrom","name":"esengstrom","emailAddress":"esengstrom@gmail.com","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Erik Engstrom","active":true},"body":"Here is a patch to AbstractArchiver that fixes the problem.  I changed the archiver to store the resources in a Map (instead of a list) with the path as the key.  The last resource added with a given path wins.","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=esengstrom","name":"esengstrom","emailAddress":"esengstrom@gmail.com","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Erik Engstrom","active":true},"created":"2008-09-05T15:02:05.182-0500","updated":"2008-09-05T15:02:05.182-0500"},{"self":"http://jira.codehaus.org/rest/api/2/issue/65466/comment/148394","id":"148394","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=jdcasey","name":"jdcasey","emailAddress":"jdcasey@commonjava.org","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"John Casey","active":true},"body":"I didn't apply the patch, as it seemed to replace a lot of logic that wasn't necessary to replace. It also didn't make any allowances for different duplicate-file behaviors that should be configurable. Instead, I migrate the duplicate-file behavior logic out of AbstractZipArchiver and formalized it to two methods in Archiver/AbstractArchiver to configure it, and four constants in Archiver to allow programmatic configuration without using raw string values.\r\n\r\nI did apply your unit test, Erik, thanks for that.","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=jdcasey","name":"jdcasey","emailAddress":"jdcasey@commonjava.org","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"John Casey","active":true},"created":"2008-09-18T17:20:37.890-0500","updated":"2008-09-18T17:20:37.890-0500"},{"self":"http://jira.codehaus.org/rest/api/2/issue/65466/comment/148397","id":"148397","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=esengstrom","name":"esengstrom","emailAddress":"esengstrom@gmail.com","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Erik Engstrom","active":true},"body":"Thanks for the fix.   Looking at your code, I have two questions:\r\n\r\n1) What is the difference between DUPLICATES_PRESERVE and DUPLICATES_SKIP?   Your code seems to treat them the same\r\n2) Is there a way to configure it so that later files replace older ones?  That is the behavior I was trying to achieve.  I wanted the archive targets to work like the directory target does.  I should have made my test clearer.\r\n\r\nThanks","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=esengstrom","name":"esengstrom","emailAddress":"esengstrom@gmail.com","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Erik Engstrom","active":true},"created":"2008-09-18T17:47:06.093-0500","updated":"2008-09-18T17:47:06.093-0500"}]},"timeoriginalestimate":null,"aggregatetimespent":null}}