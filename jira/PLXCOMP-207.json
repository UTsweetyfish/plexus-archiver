{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"137432","self":"http://jira.codehaus.org/rest/api/latest/issue/137432","key":"PLXCOMP-207","fields":{"progress":{"progress":0,"total":0},"summary":"date parsing of 'ls' output fails with german locale on macosx","timetracking":{},"issuetype":{"self":"http://jira.codehaus.org/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"http://jira.codehaus.org/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"customfield_10110":null,"votes":{"self":"http://jira.codehaus.org/rest/api/2/issue/PLXCOMP-207/votes","votes":0,"hasVoted":false},"resolution":{"self":"http://jira.codehaus.org/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"fixVersions":[],"resolutiondate":"2012-06-06T06:08:39.509-0500","customfield_10210":"0.0","timespent":null,"reporter":{"self":"http://jira.codehaus.org/rest/api/2/user?username=jan.sievers","name":"jan.sievers","emailAddress":"jan.sievers@sap.com","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Jan Sievers","active":true},"aggregatetimeoriginalestimate":null,"customfield_10161":["jan.sievers(jan.sievers)","jason(jason)"],"customfield_10160":null,"updated":"2012-06-06T06:08:39.611-0500","created":"2012-06-01T07:55:14.934-0500","description":"this is a followup on tycho bug https://bugs.eclipse.org/bugs/show_bug.cgi?id=368089 where a symptom of this bug is that all file permissions are lost in a .tar archive.\r\n\r\nThe bug is that the output of 'ls -1lna' is locale-specific and e.g. with a german locale, the month and day columns are inversed on MacOS X.\r\n\r\nexample with german locale ( LANG=de_DE.UTF-8 )\r\n\r\n$ ls -1lna\r\ntotal 24\r\ndrwxr-xr-x   5 501  20   170  1 Jun 11:02 .\r\ndrwxr-xr-x  12 501  20   408  1 Jun 10:39 ..\r\n-rw-r--r--   1 501  20   206 31 Mai 19:53 .project\r\n-rw-r--r--   1 501  20  5227  1 Jun 11:02 pom.xml\r\ndrwxr-xr-x   3 501  20   102 31 Mai 19:59 workspace\r\n\r\n\r\n\r\nexample with english locale ( LANG=en_US.UTF-8 ) \r\n\r\n\r\n$ ls -1lna\r\ntotal 24\r\ndrwxr-xr-x   5 501  20   170 Jun  1 11:02 .\r\ndrwxr-xr-x  12 501  20   408 Jun  1 10:39 ..\r\n-rw-r--r--   1 501  20   206 May 31 19:53 .project\r\n-rw-r--r--   1 501  20  5227 Jun  1 11:02 pom.xml\r\ndrwxr-xr-x   3 501  20   102 May 31 19:59 workspace\r\n\r\nThe bug is in AttributeParser [1] where the expected date format is \"MMM dd HH:mm\" but with a german locale it should be  \"dd MMM HH:mm\" instead.\r\n\r\nMaybe insteead of adding yet another date format to try a better fix would be to make sure the forked 'ls' always uses the same hardcoded LANG=en_US.UTF-8 env variable.\r\n\r\n[1] https://github.com/sonatype/plexus-io/blob/master/src/main/java/org/codehaus/plexus/components/io/attributes/AttributeParser.java#L57\r\n\r\n\r\n\r\n\r\n","priority":{"self":"http://jira.codehaus.org/rest/api/2/priority/3","iconUrl":"http://jira.codehaus.org/images/icons/priorities/major.png","name":"Major","id":"3"},"duedate":null,"issuelinks":[],"customfield_10163":"82598400","watches":{"self":"http://jira.codehaus.org/rest/api/2/issue/PLXCOMP-207/watchers","watchCount":1,"isWatching":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"subtasks":[],"status":{"self":"http://jira.codehaus.org/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"http://jira.codehaus.org/images/icons/statuses/closed.png","name":"Closed","id":"6"},"customfield_10090":null,"labels":[],"workratio":-1,"assignee":{"self":"http://jira.codehaus.org/rest/api/2/user?username=jason","name":"jason","emailAddress":"jason@takari.io","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Jason van Zyl","active":true},"attachment":[],"customfield_10221":null,"customfield_10220":null,"customfield_10200":null,"aggregatetimeestimate":null,"customfield_10190":null,"project":{"self":"http://jira.codehaus.org/rest/api/2/project/11440","id":"11440","key":"PLXCOMP","name":"Plexus Components","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/projectavatar?size=xsmall&pid=11440&avatarId=10011","24x24":"http://jira.codehaus.org/secure/projectavatar?size=small&pid=11440&avatarId=10011","32x32":"http://jira.codehaus.org/secure/projectavatar?size=medium&pid=11440&avatarId=10011","48x48":"http://jira.codehaus.org/secure/projectavatar?pid=11440&avatarId=10011"},"projectCategory":{"self":"http://jira.codehaus.org/rest/api/2/projectCategory/10003","id":"10003","description":"various containers","name":"containers"}},"versions":[{"self":"http://jira.codehaus.org/rest/api/2/version/17626","id":"17626","description":"","name":"plexus-io-2.0.2","archived":false,"released":true,"releaseDate":"2012-01-14"}],"customfield_10170":null,"environment":"macosx 10.7.4","timeestimate":null,"customfield_10130":null,"aggregateprogress":{"progress":0,"total":0},"lastViewed":null,"components":[{"self":"http://jira.codehaus.org/rest/api/2/component/14319","id":"14319","name":"plexus-io"}],"comment":{"startAt":0,"maxResults":3,"total":3,"comments":[{"self":"http://jira.codehaus.org/rest/api/2/issue/137432/comment/300186","id":"300186","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=jan.sievers","name":"jan.sievers","emailAddress":"jan.sievers@sap.com","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Jan Sievers","active":true},"body":"e.g. {code}ls -1lna --time-style=full-iso{code}\r\n\r\nwould give a non-locale specific ISO format which is less error prone to parse.\r\n\r\nUnfortunately I just verified that --time-style=full-iso is not portable across other versions of ls.\r\nUsing stat instead of ls\r\n\r\n{code}stat -c \"%A %u %g %n\"{code}\r\n\r\nwould be safely parseable I think, but we would fork one stat process per file which I guess is not acceptable from a performance POV.\r\n\r\nSo the only options are either trying to set the LANG of the forked ls process to hardcoded \"en_US.UTF-8\" or to add yet another 2 date formats\r\n\r\n{code}\r\nnew SimpleDateFormat( \"dd MMM HH:mm\" ) ,\r\nnew SimpleDateFormat( \"dd MMM yyyy\" )\r\n{code}\r\n\r\n\r\n\r\n\r\n\r\n","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=jan.sievers","name":"jan.sievers","emailAddress":"jan.sievers@sap.com","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Jan Sievers","active":true},"created":"2012-06-01T08:17:10.052-0500","updated":"2012-06-01T10:11:54.548-0500"},{"self":"http://jira.codehaus.org/rest/api/2/issue/137432/comment/300196","id":"300196","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=jan.sievers","name":"jan.sievers","emailAddress":"jan.sievers@sap.com","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Jan Sievers","active":true},"body":"looks like there is/was a macos x bug\r\nhttp://hints.macworld.com/article.php?story=20040104152157563\r\n\r\ncausing month-day order to be reversed all the time (independent of locale)\r\nstill the parser should be able to handle reversed month-day order","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=jan.sievers","name":"jan.sievers","emailAddress":"jan.sievers@sap.com","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Jan Sievers","active":true},"created":"2012-06-01T12:59:17.975-0500","updated":"2012-06-01T12:59:17.975-0500"},{"self":"http://jira.codehaus.org/rest/api/2/issue/137432/comment/300257","id":"300257","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=jan.sievers","name":"jan.sievers","emailAddress":"jan.sievers@sap.com","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Jan Sievers","active":true},"body":"pull request for fix:\r\nhttps://github.com/sonatype/plexus-io/pull/1","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=jan.sievers","name":"jan.sievers","emailAddress":"jan.sievers@sap.com","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&avatarId=10232","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&avatarId=10232","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&avatarId=10232","48x48":"http://jira.codehaus.org/secure/useravatar?avatarId=10232"},"displayName":"Jan Sievers","active":true},"created":"2012-06-03T07:22:51.472-0500","updated":"2012-06-03T07:22:51.472-0500"}]},"timeoriginalestimate":null,"aggregatetimespent":null}}