{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"155320","self":"http://jira.codehaus.org/rest/api/latest/issue/155320","key":"PLXCOMP-238","fields":{"progress":{"progress":0,"total":0},"summary":"CRC Failure if compress=false and file size <= 4 bytes","timetracking":{},"issuetype":{"self":"http://jira.codehaus.org/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"http://jira.codehaus.org/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"customfield_10110":null,"votes":{"self":"http://jira.codehaus.org/rest/api/2/issue/PLXCOMP-238/votes","votes":0,"hasVoted":false},"resolution":{"self":"http://jira.codehaus.org/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"fixVersions":[{"self":"http://jira.codehaus.org/rest/api/2/version/20664","id":"20664","name":"plexus-archiver-2.6.2","archived":false,"released":true,"releaseDate":"2014-09-30"}],"resolutiondate":"2014-09-30T08:22:05.902-0500","customfield_10210":"1.0","timespent":null,"reporter":{"self":"http://jira.codehaus.org/rest/api/2/user?username=khmarbaise","name":"khmarbaise","emailAddress":"codehaus@soebes.de","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&ownerId=khmarbaise&avatarId=10920","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&ownerId=khmarbaise&avatarId=10920","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&ownerId=khmarbaise&avatarId=10920","48x48":"http://jira.codehaus.org/secure/useravatar?ownerId=khmarbaise&avatarId=10920"},"displayName":"Karl-Heinz Marbaise","active":true},"aggregatetimeoriginalestimate":null,"customfield_10161":["khmarbaise(khmarbaise)","krosenvold(krosenvold)"],"customfield_10160":null,"updated":"2014-09-30T16:50:14.080-0500","created":"2014-07-16T05:59:43.200-0500","description":"Identified a problem in the following code area:\r\n{code:java}\r\n    public void closeEntry()\r\n        throws IOException\r\n    {\r\n        if ( entry == null )\r\n        {\r\n            return;\r\n        }\r\n\r\n        long realCrc = crc.getValue();\r\n        crc.reset();\r\n\r\n        if ( entry.getMethod() == DEFLATED )\r\n        {\r\n            def.finish();\r\n            while ( !def.finished() )\r\n            {\r\n                deflate();\r\n            }\r\n\r\n            entry.setSize( def.getBytesRead() );\r\n            entry.setComprSize( def.getTotalOut() );\r\n            entry.setCrc( realCrc );\r\n\r\n            def.reset();\r\n\r\n            written += entry.getCompressedSize();\r\n        }\r\n        else if ( raf == null )\r\n        {\r\n            if ( entry.getCrc() != realCrc )\r\n            {\r\n                throw new ZipException( \"bad CRC checksum for entry \"\r\n                                        + entry.getName() + \": \"\r\n                                        + Long.toHexString( entry.getCrc() )\r\n                                        + \" instead of \"\r\n                                        + Long.toHexString( realCrc ) );\r\n            }\r\n\r\n            if ( entry.getSize() != written - dataStart )\r\n            {\r\n                throw new ZipException( \"bad size for entry \"\r\n                                        + entry.getName() + \": \"\r\n                                        + entry.getSize()\r\n                                        + \" instead of \"\r\n                                        + ( written - dataStart ) );\r\n            }\r\n        }\r\n        else\r\n        { /* method is STORED and we used RandomAccessFile */\r\n            long size = written - dataStart;\r\n\r\n            entry.setSize( size );\r\n            entry.setComprSize( size );\r\n            entry.setCrc( realCrc );\r\n        }\r\n\r\n        // If random access output, write the local file header containing\r\n        // the correct CRC and compressed/uncompressed sizes\r\n        if ( raf != null )\r\n        {\r\n            long save = raf.getFilePointer();\r\n\r\n            raf.seek( localDataStart );\r\n            writeOut( longBytes( entry.getCrc()) );\r\n            writeOut( longBytes( entry.getCompressedSize()));\r\n            writeOut( longBytes( entry.getSize() ) );\r\n            raf.seek( save );\r\n        }\r\n\r\n        writeDataDescriptor( entry );\r\n        entry = null;\r\n    }\r\n{code}\r\nIt prints out \r\n{code}\r\nbad CRC checksum for entry mjar179/Messages_en.properties: 2144df1c instead of 0\r\n{code}\r\nThe important part is the following:\r\n{code}\r\nCaused by: java.util.zip.ZipException: bad CRC checksum for entry mjar179/Messages_en.properties: 2144df1c instead of 0\r\n\tat org.codehaus.plexus.archiver.zip.ZipOutputStream.closeEntry(ZipOutputStream.java:372)\r\n\tat org.codehaus.plexus.archiver.zip.ZipOutputStream.putNextEntry(ZipOutputStream.java:422)\r\n\tat org.codehaus.plexus.archiver.zip.AbstractZipArchiver.zipFile(AbstractZipArchiver.java:563)\r\n\tat org.codehaus.plexus.archiver.jar.JarArchiver.zipFile(JarArchiver.java:480)\r\n\tat org.codehaus.plexus.archiver.zip.AbstractZipArchiver.zipFile(AbstractZipArchiver.java:598)\r\n\t... 28 more\r\n[ERROR] \r\n{code}\r\nThe code does not handle correctly the case where compress is set to false.","priority":{"self":"http://jira.codehaus.org/rest/api/2/priority/1","iconUrl":"http://jira.codehaus.org/images/icons/priorities/blocker.png","name":"Blocker","id":"1"},"duedate":null,"issuelinks":[{"id":"35565","self":"http://jira.codehaus.org/rest/api/2/issueLink/35565","type":{"id":"10001","name":"dependent","inward":"is depended upon by","outward":"depends upon","self":"http://jira.codehaus.org/rest/api/2/issueLinkType/10001"},"inwardIssue":{"id":"154966","key":"MJAR-179","self":"http://jira.codehaus.org/rest/api/2/issue/154966","fields":{"summary":"Adding empty files to jar failed with a ZipException : bad CRC checksum","status":{"self":"http://jira.codehaus.org/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"http://jira.codehaus.org/images/icons/statuses/closed.png","name":"Closed","id":"6"},"priority":{"self":"http://jira.codehaus.org/rest/api/2/priority/1","iconUrl":"http://jira.codehaus.org/images/icons/priorities/blocker.png","name":"Blocker","id":"1"},"issuetype":{"self":"http://jira.codehaus.org/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"http://jira.codehaus.org/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}}],"customfield_10163":"9244800","watches":{"self":"http://jira.codehaus.org/rest/api/2/issue/PLXCOMP-238/watchers","watchCount":2,"isWatching":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"subtasks":[],"status":{"self":"http://jira.codehaus.org/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"http://jira.codehaus.org/images/icons/statuses/closed.png","name":"Closed","id":"6"},"customfield_10090":null,"labels":[],"workratio":-1,"assignee":{"self":"http://jira.codehaus.org/rest/api/2/user?username=krosenvold","name":"krosenvold","emailAddress":"krosenvold@apache.org","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&ownerId=krosenvold&avatarId=11127","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&ownerId=krosenvold&avatarId=11127","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&ownerId=krosenvold&avatarId=11127","48x48":"http://jira.codehaus.org/secure/useravatar?ownerId=krosenvold&avatarId=11127"},"displayName":"Kristian Rosenvold","active":true},"attachment":[{"self":"http://jira.codehaus.org/rest/api/2/attachment/66468","id":"66468","filename":"mvn.log","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=khmarbaise","name":"khmarbaise","emailAddress":"codehaus@soebes.de","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&ownerId=khmarbaise&avatarId=10920","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&ownerId=khmarbaise&avatarId=10920","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&ownerId=khmarbaise&avatarId=10920","48x48":"http://jira.codehaus.org/secure/useravatar?ownerId=khmarbaise&avatarId=10920"},"displayName":"Karl-Heinz Marbaise","active":true},"created":"2014-09-23T15:03:09.529-0500","size":186317,"mimeType":"text/plain","content":"http://jira.codehaus.org/secure/attachment/66468/mvn.log"}],"customfield_10221":null,"customfield_10220":null,"customfield_10200":null,"aggregatetimeestimate":null,"customfield_10190":null,"project":{"self":"http://jira.codehaus.org/rest/api/2/project/11440","id":"11440","key":"PLXCOMP","name":"Plexus Components","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/projectavatar?size=xsmall&pid=11440&avatarId=10011","24x24":"http://jira.codehaus.org/secure/projectavatar?size=small&pid=11440&avatarId=10011","32x32":"http://jira.codehaus.org/secure/projectavatar?size=medium&pid=11440&avatarId=10011","48x48":"http://jira.codehaus.org/secure/projectavatar?pid=11440&avatarId=10011"},"projectCategory":{"self":"http://jira.codehaus.org/rest/api/2/projectCategory/10003","id":"10003","description":"various containers","name":"containers"}},"versions":[{"self":"http://jira.codehaus.org/rest/api/2/version/19190","id":"19190","name":"plexus-archiver-2.4.4","archived":false,"released":true,"releaseDate":"2013-11-02"}],"customfield_10170":null,"environment":null,"timeestimate":null,"customfield_10130":null,"aggregateprogress":{"progress":0,"total":0},"lastViewed":null,"components":[{"self":"http://jira.codehaus.org/rest/api/2/component/12540","id":"12540","name":"plexus-archiver"}],"comment":{"startAt":0,"maxResults":5,"total":5,"comments":[{"self":"http://jira.codehaus.org/rest/api/2/issue/155320/comment/352968","id":"352968","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=krosenvold","name":"krosenvold","emailAddress":"krosenvold@apache.org","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&ownerId=krosenvold&avatarId=11127","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&ownerId=krosenvold&avatarId=11127","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&ownerId=krosenvold&avatarId=11127","48x48":"http://jira.codehaus.org/secure/useravatar?ownerId=krosenvold&avatarId=11127"},"displayName":"Kristian Rosenvold","active":true},"body":"This should be fixed as we migrated to commons-compress in 2.5","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=krosenvold","name":"krosenvold","emailAddress":"krosenvold@apache.org","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&ownerId=krosenvold&avatarId=11127","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&ownerId=krosenvold&avatarId=11127","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&ownerId=krosenvold&avatarId=11127","48x48":"http://jira.codehaus.org/secure/useravatar?ownerId=krosenvold&avatarId=11127"},"displayName":"Kristian Rosenvold","active":true},"created":"2014-09-21T14:17:16.658-0500","updated":"2014-09-21T14:17:16.658-0500"},{"self":"http://jira.codehaus.org/rest/api/2/issue/155320/comment/353094","id":"353094","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=khmarbaise","name":"khmarbaise","emailAddress":"codehaus@soebes.de","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&ownerId=khmarbaise&avatarId=10920","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&ownerId=khmarbaise&avatarId=10920","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&ownerId=khmarbaise&avatarId=10920","48x48":"http://jira.codehaus.org/secure/useravatar?ownerId=khmarbaise&avatarId=10920"},"displayName":"Karl-Heinz Marbaise","active":true},"body":"I have retested this with plexus-archiver 2.5 and unfortunately this issue still exists unchanged.\r\n \r\nSo the question is what you mean by ...commons-compress 2.5 (1.9 is the next version which is scheduled of commons compress). If this mean that this issue is currently no fixed than we should postpone but not define it as fixed which is simply not the case.\r\n","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=khmarbaise","name":"khmarbaise","emailAddress":"codehaus@soebes.de","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&ownerId=khmarbaise&avatarId=10920","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&ownerId=khmarbaise&avatarId=10920","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&ownerId=khmarbaise&avatarId=10920","48x48":"http://jira.codehaus.org/secure/useravatar?ownerId=khmarbaise&avatarId=10920"},"displayName":"Karl-Heinz Marbaise","active":true},"created":"2014-09-23T14:26:52.945-0500","updated":"2014-09-23T14:27:27.778-0500"},{"self":"http://jira.codehaus.org/rest/api/2/issue/155320/comment/353101","id":"353101","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=krosenvold","name":"krosenvold","emailAddress":"krosenvold@apache.org","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&ownerId=krosenvold&avatarId=11127","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&ownerId=krosenvold&avatarId=11127","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&ownerId=krosenvold&avatarId=11127","48x48":"http://jira.codehaus.org/secure/useravatar?ownerId=krosenvold&avatarId=11127"},"displayName":"Kristian Rosenvold","active":true},"body":"Nah, there's probably something in plexus-archiver then.","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=krosenvold","name":"krosenvold","emailAddress":"krosenvold@apache.org","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&ownerId=krosenvold&avatarId=11127","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&ownerId=krosenvold&avatarId=11127","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&ownerId=krosenvold&avatarId=11127","48x48":"http://jira.codehaus.org/secure/useravatar?ownerId=krosenvold&avatarId=11127"},"displayName":"Kristian Rosenvold","active":true},"created":"2014-09-23T14:55:34.536-0500","updated":"2014-09-23T14:55:34.536-0500"},{"self":"http://jira.codehaus.org/rest/api/2/issue/155320/comment/353103","id":"353103","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=khmarbaise","name":"khmarbaise","emailAddress":"codehaus@soebes.de","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&ownerId=khmarbaise&avatarId=10920","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&ownerId=khmarbaise&avatarId=10920","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&ownerId=khmarbaise&avatarId=10920","48x48":"http://jira.codehaus.org/secure/useravatar?ownerId=khmarbaise&avatarId=10920"},"displayName":"Karl-Heinz Marbaise","active":true},"body":"Added full maven debug output for detailed analzye and it looks like your assuption is correct...","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=khmarbaise","name":"khmarbaise","emailAddress":"codehaus@soebes.de","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&ownerId=khmarbaise&avatarId=10920","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&ownerId=khmarbaise&avatarId=10920","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&ownerId=khmarbaise&avatarId=10920","48x48":"http://jira.codehaus.org/secure/useravatar?ownerId=khmarbaise&avatarId=10920"},"displayName":"Karl-Heinz Marbaise","active":true},"created":"2014-09-23T15:03:09.546-0500","updated":"2014-09-23T15:03:09.546-0500"},{"self":"http://jira.codehaus.org/rest/api/2/issue/155320/comment/353484","id":"353484","author":{"self":"http://jira.codehaus.org/rest/api/2/user?username=krosenvold","name":"krosenvold","emailAddress":"krosenvold@apache.org","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&ownerId=krosenvold&avatarId=11127","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&ownerId=krosenvold&avatarId=11127","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&ownerId=krosenvold&avatarId=11127","48x48":"http://jira.codehaus.org/secure/useravatar?ownerId=krosenvold&avatarId=11127"},"displayName":"Kristian Rosenvold","active":true},"body":"Fixed in 3f48dce6090d626b108c62842ff097d4eb8c6807, thanks for excellent testdata","updateAuthor":{"self":"http://jira.codehaus.org/rest/api/2/user?username=krosenvold","name":"krosenvold","emailAddress":"krosenvold@apache.org","avatarUrls":{"16x16":"http://jira.codehaus.org/secure/useravatar?size=xsmall&ownerId=krosenvold&avatarId=11127","24x24":"http://jira.codehaus.org/secure/useravatar?size=small&ownerId=krosenvold&avatarId=11127","32x32":"http://jira.codehaus.org/secure/useravatar?size=medium&ownerId=krosenvold&avatarId=11127","48x48":"http://jira.codehaus.org/secure/useravatar?ownerId=krosenvold&avatarId=11127"},"displayName":"Kristian Rosenvold","active":true},"created":"2014-09-30T08:22:05.961-0500","updated":"2014-09-30T08:22:05.961-0500"}]},"timeoriginalestimate":null,"aggregatetimespent":null}}